Скрипт предназначен для организации блокировки от перебора из access.log'ов nginx при помощи iptables, без изменения самих настроек nginx и iptables.  
## Принцип работы:  
1. Лог парсится по дате и времени и выбираются записи за определённое время в минутах указанное при запуске скрипта.  
2. Из лога выбираются только ip, сортируются, считаются и самое большое количество запросов с одного IP записывается в файл __/etc/ipbans/reqests-count.txt__ в формате "<count> <ip>"  
3. Из этого файла забирается количество и проверяется превышает ли оно порог  
4. Если превышает и IP не забанен ранее - IP Блокируется через iptables, если нет - проверяется нужно ли разбанить кого-то из ранее заблокированных  
***
## Установка и использование скрипта:  
1. Склонить репозиторий или просто скопировать скрипт  
2. Создать директорию __/etc/ipbans__  
3. Создать в ней файл __/etc/ipbans/ignore_ip.list__ и внести в него IP которые никак нельзя банить  
4. Поправить в переменной __limit__ количество запросов ( по умолчанию - 150 )  
5. Добавить в crontab запись вида __/path/to/script <time>__, например __/root/scripts/ipban.sh 60__ , что значит блокировать IP у которых за 60 минут больше запросов чем установлено в скрипте  
